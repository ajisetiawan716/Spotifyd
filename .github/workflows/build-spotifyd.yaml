- name: Build with cross Docker (non-interactive)
  env:
    DEBIAN_FRONTEND: noninteractive
    TZ: UTC
  run: |
    # Set environment untuk non-interactive
    export DEBIAN_FRONTEND=noninteractive
    export TZ=UTC
    
    # Install cross
    cargo install cross --git https://github.com/cross-rs/cross
    
    # Build dengan environment variables
    git clone https://github.com/Spotifyd/spotifyd.git spotifyd-source
    cd spotifyd-source
    git checkout v0.4.1
    
    echo '[patch.crates-io]' >> Cargo.toml
    echo 'librespot = { git = "https://github.com/librespot-org/librespot.git", rev = "be37402" }' >> Cargo.toml
    
    # Build dengan cross
    cross build --release --no-default-features --features alsa_backend --target ${{ matrix.rust_target }}
    
    mkdir -p "$GITHUB_WORKSPACE/binaries"
    cp target/${{ matrix.rust_target }}/release/spotifyd "$GITHUB_WORKSPACE/binaries/spotifyd-${{ matrix.target }}"